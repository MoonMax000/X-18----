# ๐ผ๏ธ ะฅัะฐะฝะธะปะธัะต ะะตะดะธะฐ-ัะฐะนะปะพะฒ: ะะพะปะฝะพะต ะะฑัััะฝะตะฝะธะต

## ๐ ะะฐัะฐ ะขะตะบััะฐั ะกะธััะฐัะธั

### ะงัะพ ะฃ ะะฐั ะกะตะนัะฐั
```
Railway (Backend):
โโโ Redis          โ ะัั ะดะฐะฝะฝัั
โโโ Postgres       โ ะะฐะทะฐ ะดะฐะฝะฝัั (URL, ะผะตัะฐะดะฐะฝะฝัะต)
โโโ X-18----       โ Backend ัะตัะฒะธั

Netlify (Frontend):
โโโ Static files   โ HTML/CSS/JS (ะะ ะะะะะข ััะฐะฝะธัั ะทะฐะณััะทะบะธ)
```

### ะขะตะบััะฐั ะะตะฐะปะธะทะฐัะธั
ะกะผะพััั ะฒ ะบะพะด `custom-backend/internal/api/media.go`:
```go
uploadDir := "./storage/media"  // โ๏ธ ะะพะบะฐะปัะฝะฐั ัะฐะนะปะพะฒะฐั ัะธััะตะผะฐ
```

**ะะะะะะะะ:** ะคะฐะนะปั ัะพััะฐะฝััััั ะฝะฐ ะดะธัะบ Railway, ะฝะพ:
- โ ะัะธ ัะตััะฐััะต ะบะพะฝัะตะนะฝะตัะฐ ัะฐะนะปั ัะตัััััั
- โ ะัะธ ะผะฐัััะฐะฑะธัะพะฒะฐะฝะธะธ ัะฐะนะปั ะฝะต ัะธะฝััะพะฝะธะทะธัััััั ะผะตะถะดั ะธะฝััะฐะฝัะฐะผะธ
- โ ะะตั ะฑัะบะฐะฟะพะฒ
- โ ะะณัะฐะฝะธัะตะฝะฝะพะต ะผะตััะพ

---

## โ ะัะฐะฒะธะปัะฝัะต ะะตัะตะฝะธั ะดะปั Production

### ะะฐัะธะฐะฝั 1: AWS S3 (ะะตะบะพะผะตะฝะดัะตััั) ๐ฐ
**ะกัะพะธะผะพััั:** ~$0.023 ะทะฐ GB ะฒ ะผะตััั + ััะฐัะธะบ

**ะะปััั:**
- โ ะะฐะดัะถะฝะพััั 99.999999999%
- โ ะะฒัะพะผะฐัะธัะตัะบะธะต ะฑัะบะฐะฟั
- โ CDN ะธะฝัะตะณัะฐัะธั (CloudFront)
- โ ะะตััะธะพะฝะธัะพะฒะฐะฝะธะต ัะฐะนะปะพะฒ
- โ ะะตะทะปะธะผะธัะฝะพะต ััะฐะฝะธะปะธัะต

**ะัะธะผะตั ััะพะธะผะพััะธ:**
- 1 GB ัะพัะพ: $0.023/ะผะตััั
- 10 GB ัะพัะพ: $0.23/ะผะตััั
- 100 GB ัะพัะพ: $2.30/ะผะตััั

### ะะฐัะธะฐะฝั 2: Cloudflare R2 (ะะตัะตะฒะปะต) ๐
**ะกัะพะธะผะพััั:** $0.015 ะทะฐ GB ะฒ ะผะตััั, ะะะ ะฟะปะฐัั ะทะฐ ััะฐัะธะบ!

**ะะปััั:**
- โ ะะตัะตะฒะปะต ัะตะผ S3
- โ ะะตัะฟะปะฐัะฝัะน ััะฐัะธะบ (egress)
- โ S3-ัะพะฒะผะตััะธะผัะน API
- โ ะะฝัะตะณัะฐัะธั ั Cloudflare CDN

**ะัะธะผะตั ััะพะธะผะพััะธ:**
- 1 GB ัะพัะพ: $0.015/ะผะตััั
- 10 GB ัะพัะพ: $0.15/ะผะตััั
- 100 GB ัะพัะพ: $1.50/ะผะตััั

### ะะฐัะธะฐะฝั 3: Railway Volumes (ะัะตะผะตะฝะฝะพะต ัะตัะตะฝะธะต) ๐ฆ
**ะกัะพะธะผะพััั:** ะะบะปััะตะฝะพ ะฒ Railway

**ะะปััั:**
- โ ะัะพััะฐั ะฝะฐัััะพะนะบะฐ
- โ ะะตั ะดะพะฟะพะปะฝะธัะตะปัะฝะพะน ะพะฟะปะฐัั
- โ ะะตััะธััะตะฝัะฝะพะต ััะฐะฝะธะปะธัะต

**ะะธะฝััั:**
- โ ะะตั CDN
- โ ะะตะดะปะตะฝะฝะตะต ะดะปั ะณะปะพะฑะฐะปัะฝัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน
- โ ะกะปะพะถะฝะตะต ะผะฐัััะฐะฑะธัะพะฒะฐัั

---

## ๐๏ธ ะััะธัะตะบัััะฐ ะฅัะฐะฝะตะฝะธั

### ะะฐะบ ะญัะพ ะะฐะฑะพัะฐะตั
```
โโโโโโโโโโโโโโโ
โ   User      โ
โ  (Browser)  โ
โโโโโโโโฌโโโโโโโ
       โ 1. Upload file
       โผ
โโโโโโโโโโโโโโโโโโโ
โ   Netlify       โ
โ  (Frontend)     โ
โโโโโโโโโโฌโโโโโโโโโ
         โ 2. POST /api/media/upload
         โผ
โโโโโโโโโโโโโโโโโโโโ
โ  Railway Backend โ
โ  (API Server)    โ
โโโโโโโโโโฌโโโโโโโโโโ
         โ 3. Upload to storage
         โผ
โโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
โ  Cloud Storage   โ     โ  Postgres    โ
โ  (S3/R2/Volume)  โ     โ  (Metadata)  โ
โ  - Actual files  โ     โ  - URLs      โ
โ  - Images        โ     โ  - Sizes     โ
โ  - Videos        โ     โ  - User IDs  โ
โโโโโโโโโโโโโโโโโโโโ     โโโโโโโโโโโโโโโโ
```

### ะงัะพ ะฅัะฐะฝะธััั ะะดะต

**Postgres (ะะฐะทะฐ ะดะฐะฝะฝัั):**
```sql
-- ะขะฐะฑะปะธัะฐ media
id          uuid
user_id     uuid
url         text          -- https://cdn.tyriantrade.com/abc123.jpg
type        varchar       -- image, video, gif
size_bytes  bigint
width       int
height      int
created_at  timestamp
```

**S3/R2/Volume (ะคะฐะนะปะพะฒะพะต ััะฐะฝะธะปะธัะต):**
```
storage/
โโโ media/
โ   โโโ abc123-def456.jpg
โ   โโโ ghi789-jkl012.mp4
โ   โโโ thumb_abc123-def456.jpg
```

---

## ๐ ะะตะบะพะผะตะฝะดะฐัะธั ะดะปั ะะฐั

### ะะปั ะกัะฐััะฐ (ะกะตะนัะฐั)
**Railway Volumes** - ะฟัะพััะพะต ัะตัะตะฝะธะต ะดะปั ะฝะฐัะฐะปะฐ

### ะะปั Production (ะะพะทะถะต)
**Cloudflare R2** - ะปัััะตะต ัะพะพัะฝะพัะตะฝะธะต ัะตะฝะฐ/ะบะฐัะตััะฒะพ

---

## ๐ ะะปะฐะฝ ะะตะนััะฒะธะน

### ะญัะฐะฟ 1: Railway Volumes (ะัััััะน ััะฐัั)
```bash
# ะ Railway ะดะพะฑะฐะฒะธัั Volume:
# 1. ะะฐะนัะธ ะฒ ะฟัะพะตะบั X-18----
# 2. Volumes โ New Volume
# 3. Mount Path: /app/storage
# 4. Size: 10GB (ะดะปั ะฝะฐัะฐะปะฐ)
```

### ะญัะฐะฟ 2: ะะฑะฝะพะฒะธัั Backend
ะขะตะบััะธะน ะบะพะด ัะถะต ะฟัะฐะฒะธะปัะฝัะน! ะัะพััะพ ะธัะฟะพะปัะทัะตััั `./storage/media`

### ะญัะฐะฟ 3: ะะฐัััะพะธัั BASE_URL
ะ Railway ะดะพะฑะฐะฒะธัั ะฟะตัะตะผะตะฝะฝัั:
```
BASE_URL=https://api.tyriantrade.com
```

### ะญัะฐะฟ 4: (ะะฟัะธะพะฝะฐะปัะฝะพ) ะะธะณัะฐัะธั ะฝะฐ S3/R2
ะะพะณะดะฐ ะฟัะพะตะบั ะฒััะฐััะตั, ะผะพะถะฝะพ ะฟะตัะตะฝะตััะธ ะฝะฐ ะพะฑะปะฐะบะพ.

---

## ๐ก ะะฐะถะฝัะต ะะพะผะตะฝัั

### 1. Netlify ะะ ะฅะะะะะข ะทะฐะณััะถะตะฝะฝัะต ัะฐะนะปั
Netlify - ััะพ ััะฐัะธัะตัะบะธะน ัะพััะธะฝะณ:
- โ ะะพะถะตั ะพัะดะฐะฒะฐัั ัะฐะนะปั ะบะพัะพััะต ะฒั ะทะฐะดะตะฟะปะพะธะปะธ
- โ ะะ ะผะพะถะตั ัะพััะฐะฝััั ัะฐะนะปั ะบะพัะพััะต ะฟะพะปัะทะพะฒะฐัะตะปะธ ะทะฐะณััะถะฐัั

### 2. Backend ะฝะฐ Railway ะะะะะข ััะฐะฝะธัั ัะฐะนะปั
ะะพ ัะพะปัะบะพ ั Volume:
- โ ะะะ Volume: ัะฐะนะปั ะฟัะพะฟะฐะดัั ะฟัะธ ัะตััะฐััะต
- โ ะก Volume: ัะฐะนะปั ัะพััะฐะฝััััั

### 3. URL ัะฐะนะปะพะฒ
```javascript
// ะะะะะะะะะฌะะ:
url: "https://social.tyriantrade.com/uploads/photo.jpg"  // โ

// ะะะะะะะฌะะ:
url: "https://api.tyriantrade.com/storage/media/abc-123.jpg"  // โ
```

### 4. ะัะดะฐัะฐ ัะฐะนะปะพะฒ
ะ ะฒะฐัะตะผ backend ัะถะต ะตััั ัะพัั ะดะปั ะพัะดะฐัะธ:
```go
// GET /storage/media/:filename
app.Static("/storage/media", "./storage/media")
```

---

## ๐ง ะงัะพ ะัะถะฝะพ ะกะดะตะปะฐัั ะััะผะพ ะกะตะนัะฐั

### 1. ะกะพะทะดะฐัั Volume ะฒ Railway
```
1. ะัะบัััั Railway โ X-18---- ะฟัะพะตะบั
2. ะะบะปะฐะดะบะฐ "Variables"
3. ะะฐะถะฐัั "+ New Variable"
4. ะะผั: RAILWAY_VOLUME_MOUNT_PATH
5. ะะฝะฐัะตะฝะธะต: /app/storage
```

### 2. ะัะพะฒะตัะธัั ะฟะตัะตะผะตะฝะฝัั BASE_URL
```
1. ะ Railway โ Variables
2. ะะพะฑะฐะฒะธัั: BASE_URL = https://api.tyriantrade.com
```

### 3. ะะตัะตะดะตะฟะปะพะธัั backend
ะะพัะปะต ะดะพะฑะฐะฒะปะตะฝะธั Volume ะฝัะถะตะฝ ัะตััะฐัั:
```
Railway โ Deployments โ Redeploy
```

---

## ๐ ะกัะฐะฒะฝะตะฝะธะต ะะฐัะธะฐะฝัะพะฒ

| ะัะธัะตัะธะน | Railway Volume | Cloudflare R2 | AWS S3 |
|----------|---------------|---------------|---------|
| **ะกัะพะธะผะพััั** | ะะบะปััะตะฝะพ | $0.015/GB | $0.023/GB |
| **ะขัะฐัะธะบ** | ะะตัะฟะปะฐัะฝะพ | ะะตัะฟะปะฐัะฝะพ | ~$0.09/GB |
| **CDN** | โ | โ | โ (+$) |
| **ะะฐะดัะถะฝะพััั** | ะกัะตะดะฝัั | ะััะพะบะฐั | ะัะตะฝั ะฒััะพะบะฐั |
| **ะกะปะพะถะฝะพััั** | ะัะพััะฐั | ะกัะตะดะฝัั | ะกัะตะดะฝัั |
| **ะะปั ััะฐััะฐ** | โ | โ๏ธ | โ๏ธ |
| **ะะปั ะผะฐัััะฐะฑะฐ** | โ | โ | โ |

---

## ๐ฏ ะะพะน ะกะพะฒะตั

**ะกะตะนัะฐั:** ะัะฟะพะปัะทัะนัะต Railway Volumes
- ะััััะพ ะฝะฐัััะพะธัั
- ะะตั ะดะพะฟะพะปะฝะธัะตะปัะฝัั ะทะฐััะฐั
- ะะพััะฐัะพัะฝะพ ะดะปั ะฟะตัะฒัั ะฟะพะปัะทะพะฒะฐัะตะปะตะน

**ะะพะณะดะฐ ะผะฐัััะฐะฑะธััะตัะตัั:** ะะตัะตัะพะดะธัะต ะฝะฐ Cloudflare R2
- ะะตัะตะฒะปะต AWS
- ะะตัะฟะปะฐัะฝัะน ััะฐัะธะบ
- ะะปะพะฑะฐะปัะฝัะน CDN

**ะงะตัะตะท ะณะพะด:** ะัะปะธ ะฝัะถะฝะฐ ะผะฐะบัะธะผะฐะปัะฝะฐั ะฝะฐะดัะถะฝะพััั โ AWS S3

---

## โ ะงะฐัััะต ะะพะฟัะพัั

**Q: ะะพะถะฝะพ ะปะธ ััะฐะฝะธัั ะฒ Postgres?**
A: ะะตั! ะะฐะทะฐ ะดะฐะฝะฝัั ะดะปั ะผะตัะฐะดะฐะฝะฝัั, ะฝะต ะดะปั ะฑะธะฝะฐัะฝัั ัะฐะนะปะพะฒ.

**Q: ะะพะถะฝะพ ะปะธ ััะฐะฝะธัั ะฒ Redis?**
A: ะะตั! Redis ะดะปั ะบััะฐ, ะฝะต ะดะปั ะฟะพััะพัะฝะฝะพะณะพ ััะฐะฝะตะฝะธั.

**Q: ะะพัะตะผั ะฝะต ััะฐะฝะธัั ะฝะฐ Netlify?**
A: Netlify - ััะฐัะธัะตัะบะธะน ัะพััะธะฝะณ, ะฝะต ะฟะพะดะดะตัะถะธะฒะฐะตั ะทะฐะณััะทะบะธ.

**Q: ะกะบะพะปัะบะพ ะผะตััะฐ ะฝัะถะฝะพ ะฒ ะฝะฐัะฐะปะต?**
A: 5-10 GB ะดะพััะฐัะพัะฝะพ ะดะปั ััะฐััะฐ (โ1000 ัะพัะพ ะฒ HD).

---

## ๐ ะกะปะตะดัััะธะต ะจะฐะณะธ

ะฅะพัะธัะต ััะพะฑั ั:
1. โ ะะฐัััะพะธะป Railway Volume ะฟััะผะพ ัะตะนัะฐั?
2. โ ะะพะบะฐะทะฐะป ะบะฐะบ ะธะฝัะตะณัะธัะพะฒะฐัั Cloudflare R2?
3. โ ะกะพะทะดะฐะป ัะบัะธะฟั ะผะธะณัะฐัะธะธ ะฝะฐ S3?

ะะฐะฟะธัะธัะต ััะพ ะฒะฐะผ ะฝัะถะฝะพ!
