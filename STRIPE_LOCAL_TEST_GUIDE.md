# üéØ –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é Stripe –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –ª–æ–∫–∞–ª—å–Ω–æ

## ‚úÖ –ß—Ç–æ —É–∂–µ –≥–æ—Ç–æ–≤–æ

### Backend (Go)
- ‚úÖ Stripe –∫–ª—é—á–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env`
- ‚úÖ –¢–∞–±–ª–∏—Ü—ã –ë–î —Å–æ–∑–¥–∞–Ω—ã (`post_purchases`, `subscriptions`, `payment_history`)
- ‚úÖ API endpoints –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π
- ‚úÖ –ú–æ–¥–µ–ª–∏ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏
- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤—Å–µ –æ—à–∏–±–∫–∏ –∫–æ–º–ø–∏–ª—è—Ü–∏–∏

### Frontend (React)
- ‚úÖ Stripe –∫–ª—é—á–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `.env.local`
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è –ø–ª–∞—Ç–µ–∂–µ–π (`PaymentModal`, `FollowModal`)
- ‚úÖ –ö–æ–º–ø–æ–Ω–µ–Ω—Ç –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞ (`LockedPostPlaceholder`)
- ‚è≥ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Stripe –±–∏–±–ª–∏–æ—Ç–µ–∫ (–≤ –ø—Ä–æ—Ü–µ—Å—Å–µ)

## üöÄ –ó–∞–ø—É—Å–∫ —Å–∏—Å—Ç–µ–º—ã

```bash
# –ï—Å–ª–∏ —Å–µ—Ä–≤–∏—Å—ã –µ—â–µ –Ω–µ –∑–∞–ø—É—â–µ–Ω—ã
./START_CUSTOM_BACKEND_STACK.sh
```

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–µ–π

### 1. –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–Ω–æ–≥–æ –ø–æ—Å—Ç–∞
1. –í–æ–π–¥–∏—Ç–µ –≤ —Å–∏—Å—Ç–µ–º—É
2. –°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π –ø–æ—Å—Ç
3. –í –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –¥–æ—Å—Ç—É–ø–∞ –≤—ã–±–µ—Ä–∏—Ç–µ "Pay-per-post"
4. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ —Ü–µ–Ω—É (–Ω–∞–ø—Ä–∏–º–µ—Ä, $5.00)
5. –û–ø—É–±–ª–∏–∫—É–π—Ç–µ –ø–æ—Å—Ç

### 2. –ü–æ–∫—É–ø–∫–∞ –ø–æ—Å—Ç–∞
1. –í–æ–π–¥–∏—Ç–µ –ø–æ–¥ –¥—Ä—É–≥–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
2. –ù–∞–π–¥–∏—Ç–µ –ø–ª–∞—Ç–Ω—ã–π –ø–æ—Å—Ç –≤ –ª–µ–Ω—Ç–µ
3. –ù–∞–∂–º–∏—Ç–µ –Ω–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
4. –ü–æ—è–≤–∏—Ç—Å—è –º–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ–ø–ª–∞—Ç—ã
5. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ç–µ—Å—Ç–æ–≤—É—é –∫–∞—Ä—Ç—É Stripe

### 3. –¢–µ—Å—Ç–æ–≤—ã–µ –∫–∞—Ä—Ç—ã Stripe

| –ö–∞—Ä—Ç–∞ | –ù–æ–º–µ—Ä | CVV | –î–∞—Ç–∞ |
|-------|-------|-----|------|
| –£—Å–ø–µ—à–Ω–∞—è –æ–ø–ª–∞—Ç–∞ | 4242 4242 4242 4242 | –õ—é–±–æ–π | –õ—é–±–∞—è –≤ –±—É–¥—É—â–µ–º |
| –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ | 4000 0000 0000 0002 | –õ—é–±–æ–π | –õ—é–±–∞—è –≤ –±—É–¥—É—â–µ–º |
| 3D Secure | 4000 0025 0000 3155 | –õ—é–±–æ–π | –õ—é–±–∞—è –≤ –±—É–¥—É—â–µ–º |

## üìä API Endpoints

### –°–æ–∑–¥–∞–Ω–∏–µ –ø–ª–∞—Ç–µ–∂–∞
```bash
POST http://localhost:8080/api/stripe/payment-intent
{
  "post_id": "uuid-–ø–æ—Å—Ç–∞",
  "type": "unlock" // –∏–ª–∏ "subscribe"
}
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –ø–æ—Å—Ç—É
```bash
GET http://localhost:8080/api/posts/{post-id}/access
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –ø–æ–∫—É–ø–æ–∫
```bash
GET http://localhost:8080/api/stripe/purchases
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–æ–∫
```bash
GET http://localhost:8080/api/stripe/subscriptions
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–∫—É–ø–∫–∏ –ø–æ—Å—Ç–æ–≤
SELECT * FROM post_purchases;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–ø–∏—Å–∫–∏
SELECT * FROM subscriptions;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å—Ç–æ—Ä–∏—é –ø–ª–∞—Ç–µ–∂–µ–π
SELECT * FROM payment_history;
```

## üêõ –û—Ç–ª–∞–¥–∫–∞

### –õ–æ–≥–∏ –±—ç–∫–µ–Ω–¥–∞
```bash
tail -f custom-backend.log
```

### –õ–æ–≥–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
```bash
tail -f frontend.log
```

### –ö–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞
–û—Ç–∫—Ä–æ–π—Ç–µ Developer Tools (F12) –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
- Network tab –¥–ª—è API –∑–∞–ø—Ä–æ—Å–æ–≤
- Console –¥–ª—è –æ—à–∏–±–æ–∫ JavaScript

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **Webhook Secret**: –î–ª—è –ø–æ–ª–Ω–æ–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏ webhook'–æ–≤ –Ω—É–∂–Ω–æ:
   - –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å Stripe CLI: `brew install stripe/stripe-cli/stripe`
   - –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ—Å–ª—É—à–∏–≤–∞–Ω–∏–µ: `stripe listen --forward-to localhost:8080/api/stripe/webhook`
   - –û–±–Ω–æ–≤–∏—Ç—å `STRIPE_WEBHOOK_SECRET` –≤ `.env`

2. **–¢–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º**: –í—Å–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–æ—Ö–æ–¥—è—Ç –≤ —Ç–µ—Å—Ç–æ–≤–æ–º —Ä–µ–∂–∏–º–µ Stripe, —Ä–µ–∞–ª—å–Ω—ã–µ –¥–µ–Ω—å–≥–∏ –Ω–µ —Å–ø–∏—Å—ã–≤–∞—é—Ç—Å—è

3. **–û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö**: –ü—Ä–∏ –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ –º–æ–∂–Ω–æ –æ—á–∏—Å—Ç–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –¥–∞–Ω–Ω—ã–µ:
```sql
DELETE FROM post_purchases;
DELETE FROM subscriptions;
DELETE FROM payment_history;
```

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. –ó–∞–≤–µ—Ä—à–∏—Ç—å —É—Å—Ç–∞–Ω–æ–≤–∫—É Stripe –±–∏–±–ª–∏–æ—Ç–µ–∫ –¥–ª—è —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞
2. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–Ω—ã–π —Ü–∏–∫–ª –æ–ø–ª–∞—Ç—ã
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å webhook'–∏ –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π Stripe
4. –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –ø–ª–∞—Ç–µ–∂–µ–π –≤ –ø—Ä–æ—Ñ–∏–ª–µ
5. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É –≤—ã–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤ –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤

## üéâ –ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!

–ü–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –±–∏–±–ª–∏–æ—Ç–µ–∫:
1. –û—Ç–∫—Ä–æ–π—Ç–µ http://localhost:5173
2. –°–æ–∑–¥–∞–π—Ç–µ –ø–ª–∞—Ç–Ω—ã–π –∫–æ–Ω—Ç–µ–Ω—Ç
3. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ –ø–æ–∫—É–ø–∫—É —Å —Ç–µ—Å—Ç–æ–≤–æ–π –∫–∞—Ä—Ç–æ–π
