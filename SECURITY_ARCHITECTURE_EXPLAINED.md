# üîê –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ X-18

## ‚úÖ –¢–µ–∫—É—â–µ–µ –°–æ—Å—Ç–æ—è–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∏–º–µ–µ—Ç **–¥–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤—É—é –∑–∞—â–∏—Ç—É**, —á—Ç–æ —è–≤–ª—è–µ—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º –∏ –±–µ–∑–æ–ø–∞—Å–Ω—ã–º –ø–æ–¥—Ö–æ–¥–æ–º.

---

## üéØ –£—Ä–æ–≤–µ–Ω—å 1: –ó–∞—â–∏—Ç–∞ Frontend

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
**–§–∞–π–ª**: `client/pages/ProfileNew.tsx`

```typescript
const { user, isAuthenticated } = useAuth();
const navigate = useNavigate();

useEffect(() => {
  if (!isAuthenticated) {
    console.log('‚ö†Ô∏è User not authenticated, redirecting to /feedtest');
    navigate('/feedtest', { replace: true });
  }
}, [isAuthenticated, navigate]);
```

### –ß—Ç–æ –ó–∞—â–∏—â–∞–µ—Ç
- ‚úÖ –ü—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –¥–æ—Å—Ç—É–ø –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∫ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/profile`
- ‚úÖ –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞ `/feedtest` 
- ‚úÖ –£–ª—É—á—à–∞–µ—Ç UX (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å—Ä–∞–∑—É –≤–∏–¥–∏—Ç —Ä–µ–¥–∏—Ä–µ–∫—Ç)

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
‚ö†Ô∏è **–ú–æ–∂–µ—Ç –±—ã—Ç—å –æ–±–æ–π–¥–µ–Ω–∞**: –û–ø—ã—Ç–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –æ—Ç–∫–ª—é—á–∏—Ç—å JavaScript –∏–ª–∏ –º–∞–Ω–∏–ø—É–ª–∏—Ä–æ–≤–∞—Ç—å –∫–æ–¥–æ–º –≤ –±—Ä–∞—É–∑–µ—Ä–µ

---

## üõ°Ô∏è –£—Ä–æ–≤–µ–Ω—å 2: –ó–∞—â–∏—Ç–∞ Backend (–ì–õ–ê–í–ù–ê–Ø)

### –†–µ–∞–ª–∏–∑–∞—Ü–∏—è
**–§–∞–π–ª**: `custom-backend/cmd/server/main.go`

#### –ó–∞—â–∏—â–µ–Ω–Ω—ã–µ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã –ü—Ä–æ—Ñ–∏–ª—è
```go
users := apiGroup.Group("/users")

// ‚úÖ –ó–ê–©–ò–©–ï–ù–û - —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
users.Get("/me", middleware.JWTMiddleware(cfg), usersHandler.GetMe)
users.Patch("/me", middleware.JWTMiddleware(cfg), usersHandler.UpdateProfile)
users.Post("/:id/follow", middleware.JWTMiddleware(cfg), usersHandler.FollowUser)
users.Delete("/:id/follow", middleware.JWTMiddleware(cfg), usersHandler.UnfollowUser)
```

#### –ü—É–±–ª–∏—á–Ω—ã–µ –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã (–≠—Ç–æ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!)
```go
// ‚úÖ –ü–£–ë–õ–ò–ß–ù–´–ï - –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–∏)
users.Get("/username/:username", usersHandler.GetUserByUsername)
users.Get("/:id", usersHandler.GetUser)
users.Get("/:id/posts", usersHandler.GetUserPosts)
users.Get("/:id/followers", usersHandler.GetFollowers)
users.Get("/:id/following", usersHandler.GetFollowing)
```

### –ö–∞–∫ –†–∞–±–æ—Ç–∞–µ—Ç JWT Middleware

**–§–∞–π–ª**: `custom-backend/pkg/middleware/auth.go`

```go
func JWTMiddleware(config *configs.Config) fiber.Handler {
    return func(c *fiber.Ctx) error {
        // 1. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∑–∞–≥–æ–ª–æ–≤–∫–∞ Authorization
        authHeader := c.Get("Authorization")
        if authHeader == "" {
            return c.Status(401).JSON(fiber.Map{
                "error": "Missing authorization header",
            })
        }

        // 2. –ü—Ä–æ–≤–µ—Ä—è–µ—Ç —Ñ–æ—Ä–º–∞—Ç Bearer —Ç–æ–∫–µ–Ω–∞
        parts := strings.Split(authHeader, " ")
        if len(parts) != 2 || parts[0] != "Bearer" {
            return c.Status(401).JSON(fiber.Map{
                "error": "Invalid authorization format",
            })
        }

        // 3. –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç JWT —Ç–æ–∫–µ–Ω
        token := parts[1]
        claims, err := auth.ValidateAccessToken(token, config.JWT.AccessSecret)
        if err != nil {
            return c.Status(401).JSON(fiber.Map{
                "error": "Invalid or expired token",
            })
        }

        // 4. –î–æ–±–∞–≤–ª—è–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç
        c.Locals("userID", claims.UserID)
        c.Locals("username", claims.Username)
        c.Locals("email", claims.Email)

        return c.Next()
    }
}
```

### –ß—Ç–æ –ó–∞—â–∏—â–∞–µ—Ç
- ‚úÖ **–ù–ï –ú–û–ñ–ï–¢ –±—ã—Ç—å –æ–±–æ–π–¥–µ–Ω–∞** - —Å–µ—Ä–≤–µ—Ä –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –∫–∞–∂–¥—ã–π –∑–∞–ø—Ä–æ—Å
- ‚úÖ –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç `401 Unauthorized` –±–µ–∑ –≤–∞–ª–∏–¥–Ω–æ–≥–æ —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–æ–¥–ø–∏—Å—å –∏ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ò–∑–≤–ª–µ–∫–∞–µ—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –¥–∞–ª—å–Ω–µ–π—à–µ–π —Ä–∞–±–æ—Ç—ã

---

## üîÑ –ö–∞–∫ –†–∞–±–æ—Ç–∞—é—Ç –û–±–∞ –£—Ä–æ–≤–Ω—è –í–º–µ—Å—Ç–µ

### –°—Ü–µ–Ω–∞—Ä–∏–π 1: –ù–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø—ã—Ç–∞–µ—Ç—Å—è –∑–∞–π—Ç–∏ –Ω–∞ /profile

```
1. Frontend (ProfileNew.tsx)
   ‚Üì
   –ü—Ä–æ–≤–µ—Ä–∫–∞: isAuthenticated = false
   ‚Üì
   –†–µ–¥–∏—Ä–µ–∫—Ç ‚Üí /feedtest
   ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª–µ–Ω

2. –ï—Å–ª–∏ –±—ã –æ–Ω –≤—Å–µ-—Ç–∞–∫–∏ –æ—Ç–ø—Ä–∞–≤–∏–ª –∑–∞–ø—Ä–æ—Å –∫ API
   ‚Üì
   GET /api/users/me
   ‚Üì
   Backend (JWTMiddleware)
   ‚Üì
   –ü—Ä–æ–≤–µ—Ä–∫–∞: Authorization header –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
   ‚Üì
   Response: 401 Unauthorized
   ‚úÖ –î–æ—Å—Ç—É–ø –∑–∞–ø—Ä–µ—â–µ–Ω
```

### –°—Ü–µ–Ω–∞—Ä–∏–π 2: –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞—Ö–æ–¥–∏—Ç –Ω–∞ /profile

```
1. Frontend (ProfileNew.tsx)
   ‚Üì
   –ü—Ä–æ–≤–µ—Ä–∫–∞: isAuthenticated = true
   ‚Üì
   –°—Ç—Ä–∞–Ω–∏—Ü–∞ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è
   ‚Üì
   –ó–∞–ø—Ä–æ—Å: GET /api/users/me
   Headers: Authorization: Bearer <valid_token>
   
2. Backend (JWTMiddleware)
   ‚Üì
   –ü—Ä–æ–≤–µ—Ä–∫–∞: —Ç–æ–∫–µ–Ω –≤–∞–ª–∏–¥–µ–Ω
   ‚Üì
   –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ: userID, username, email
   ‚Üì
   –û–±—Ä–∞–±–æ—Ç—á–∏–∫: usersHandler.GetMe
   ‚Üì
   Response: 200 OK + –¥–∞–Ω–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª—è
   ‚úÖ –î–æ—Å—Ç—É–ø —Ä–∞–∑—Ä–µ—à–µ–Ω
```

---

## üìä –ú–∞—Ç—Ä–∏—Ü–∞ –ó–∞—â–∏—Ç—ã –≠–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

| –≠–Ω–¥–ø–æ–∏–Ω—Ç | –¢—Ä–µ–±—É–µ—Ç JWT? | –ü—Ä–∏—á–∏–Ω–∞ |
|----------|--------------|---------|
| `GET /api/users/me` | ‚úÖ –î–ê | –õ–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `PATCH /api/users/me` | ‚úÖ –î–ê | –ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª—è |
| `POST /api/users/:id/follow` | ‚úÖ –î–ê | –î–µ–π—Å—Ç–≤–∏–µ –æ—Ç –∏–º–µ–Ω–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è |
| `GET /api/users/:id` | ‚ùå –ù–ï–¢ | –ü—É–±–ª–∏—á–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å (–∫–∞–∫ –≤ Twitter/X) |
| `GET /api/users/:id/posts` | ‚ùå –ù–ï–¢ | –ü—É–±–ª–∏—á–Ω—ã–µ –ø–æ—Å—Ç—ã (–∫–∞–∫ –≤ Twitter/X) |
| `GET /api/users/:id/followers` | ‚ùå –ù–ï–¢ | –ü—É–±–ª–∏—á–Ω—ã–π —Å–ø–∏—Å–æ–∫ (–∫–∞–∫ –≤ Twitter/X) |
| `GET /api/timeline/home` | ‚úÖ –î–ê | –ü–µ—Ä—Å–æ–Ω–∞–ª—å–Ω–∞—è –ª–µ–Ω—Ç–∞ |
| `GET /api/timeline/explore` | ‚ùå –ù–ï–¢ | –ü—É–±–ª–∏—á–Ω–∞—è –ª–µ–Ω—Ç–∞ |

---

## ‚úÖ –ò—Ç–æ–≥: –í—Å–µ –ü—Ä–∞–≤–∏–ª—å–Ω–æ!

### –ß—Ç–æ –£–∂–µ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. ‚úÖ **Frontend –∑–∞—â–∏—Ç–∞** - –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–∞–µ—Ç –Ω–∞–≤–∏–≥–∞—Ü–∏—é –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö
2. ‚úÖ **Backend –∑–∞—â–∏—Ç–∞** - —Ä–µ–∞–ª—å–Ω–∞—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –Ω–∞ —É—Ä–æ–≤–Ω–µ API
3. ‚úÖ **JWT –≤–∞–ª–∏–¥–∞—Ü–∏—è** - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ –∏ —Å—Ä–æ–∫–∞ –¥–µ–π—Å—Ç–≤–∏—è
4. ‚úÖ **–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ** - –ø—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã, –ª–∏—á–Ω—ã–µ –∑–∞—â–∏—â–µ–Ω—ã
5. ‚úÖ **Graceful degradation** - –ø—É–±–ª–∏—á–Ω—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã –≤—Å–µ–º

### –≠—Ç–æ –°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –ü—Ä–∞–∫—Ç–∏–∫–∞

–¢–∞–∫–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤:
- Twitter/X
- Instagram
- Facebook
- LinkedIn
- –í—Å–µ—Ö —Å–æ–≤—Ä–µ–º–µ–Ω–Ω—ã—Ö —Å–æ—Ü–∏–∞–ª—å–Ω—ã—Ö —Å–µ—Ç—è—Ö

**–ü—É–±–ª–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ –î–û–õ–ñ–ù–´ –±—ã—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã –±–µ–∑ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏**, –∏–Ω–∞—á–µ:
- –ù–µ–ª—å–∑—è –ø–æ–¥–µ–ª–∏—Ç—å—Å—è —Å—Å—ã–ª–∫–æ–π –Ω–∞ –ø—Ä–æ—Ñ–∏–ª—å
- –ù–µ–ª—å–∑—è –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª–∏ –±–µ–∑ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- –•—É–∂–µ SEO (–ø–æ–∏—Å–∫–æ–≤–∏–∫–∏ –Ω–µ –∏–Ω–¥–µ–∫—Å–∏—Ä—É—é—Ç)

---

## üîí –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –£–∂–µ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ

1. ‚úÖ **CORS –∑–∞—â–∏—Ç–∞** - —Ç–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origin'—ã
2. ‚úÖ **Rate limiting** —á–µ—Ä–µ–∑ Redis
3. ‚úÖ **Bcrypt –¥–ª—è –ø–∞—Ä–æ–ª–µ–π** - –Ω–µ–æ–±—Ä–∞—Ç–∏–º–æ–µ —Ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ
4. ‚úÖ **JWT —Å –∫–æ—Ä–æ—Ç–∫–∏–º —Å—Ä–æ–∫–æ–º –∂–∏–∑–Ω–∏** (15 –º–∏–Ω—É—Ç access token)
5. ‚úÖ **Refresh token rotation** - –±–µ–∑–æ–ø–∞—Å–Ω–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ
6. ‚úÖ **–í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö input'–æ–≤** –Ω–∞ backend

### –ú–æ–∂–Ω–æ –î–æ–±–∞–≤–∏—Ç—å (–û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

- [ ] **2FA** (–¥–≤—É—Ö—Ñ–∞–∫—Ç–æ—Ä–Ω–∞—è –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
- [ ] **IP whitelist/blacklist**
- [ ] **Captcha** –Ω–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏
- [ ] **Webhook –¥–ª—è –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏**

---

## üìù –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–í–æ–ø—Ä–æ—Å**: "–∞ –Ω–∞ –±–µ–∫—ç–Ω–¥–µ —Ç—ã —Ç–æ–∂–µ –¥–µ–ª–∞–µ—à—å —ç—Ç—É –∑–∞—â–∏—Ç—É?"

**–û—Ç–≤–µ—Ç**: ‚úÖ **–î–ê! –ó–∞—â–∏—Ç–∞ –Ω–∞ –±—ç–∫–µ–Ω–¥–µ –£–ñ–ï –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ!**

- Frontend –∑–∞—â–∏—Ç–∞ (—Ä–µ–¥–∏—Ä–µ–∫—Ç) - –¥–ª—è UX
- Backend –∑–∞—â–∏—Ç–∞ (JWT middleware) - –¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –ü—É–±–ª–∏—á–Ω—ã–µ —ç–Ω–¥–ø–æ–∏–Ω—Ç—ã –æ—Ç–∫—Ä—ã—Ç—ã —Å–ø–µ—Ü–∏–∞–ª—å–Ω–æ - —ç—Ç–æ –Ω–æ—Ä–º–∞ –¥–ª—è —Å–æ—Ü. —Å–µ—Ç–∏

–ú–æ–∂–µ—Ç–µ —Å–ø–æ–∫–æ–π–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º—É - –æ–Ω–∞ –∑–∞—â–∏—â–µ–Ω–∞ –Ω–∞ –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–º —É—Ä–æ–≤–Ω–µ! üîê
