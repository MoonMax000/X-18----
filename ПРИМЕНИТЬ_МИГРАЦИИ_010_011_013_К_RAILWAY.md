# –ö–∞–∫ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏ 010, 011, 013 –∫ Railway –ë–î

## ‚ùó –ü—Ä–æ–±–ª–µ–º–∞
–û—à–∏–±–∫–∞: `could not translate host name "..." to address`

–≠—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –≤–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ URL –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏—Å—å —Å–∏–º–≤–æ–ª—ã `...`

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–ø–æ—Å–æ–±

### –®–∞–≥ 1: –ü–æ–ª—É—á–∏—Ç–µ –Ω–∞—Å—Ç–æ—è—â–∏–π DATABASE_URL –∏–∑ Railway

1. –û—Ç–∫—Ä–æ–π—Ç–µ https://railway.app/
2. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ –≤–∞—à –ø—Ä–æ–µ–∫—Ç
3. –ù–∞–π–¥–∏—Ç–µ PostgreSQL service
4. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ **Variables**
5. –ù–∞–π–¥–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é `DATABASE_URL`
6. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ **–ø–æ–ª–Ω—ã–π URL** (–æ–Ω –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å –ø—Ä–∏–º–µ—Ä–Ω–æ —Ç–∞–∫):
   ```
   postgresql://postgres:–ø–∞—Ä–æ–ª—å@—Ö–æ—Å—Ç:–ø–æ—Ä—Ç/–±–∞–∑–∞
   ```

### –®–∞–≥ 2: –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é —Å –†–ï–ê–õ–¨–ù–´–ú URL

```bash
export RAILWAY_DATABASE_URL='postgresql://postgres:–†–ï–ê–õ–¨–ù–´–ô_–ü–ê–†–û–õ–¨@–†–ï–ê–õ–¨–ù–´–ô_–•–û–°–¢:5432/railway'
```

**–í–∞–∂–Ω–æ:** –ó–∞–º–µ–Ω–∏—Ç–µ –≤–µ—Å—å URL –Ω–∞ —Ç–æ—Ç, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞–ª–∏ –∏–∑ Railway!

### –®–∞–≥ 3: –ó–∞–ø—É—Å—Ç–∏—Ç–µ —Å–∫—Ä–∏–ø—Ç

```bash
./apply-migrations-010-011-013.sh railway
```

## üîÑ –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–±: –ü—Ä–∏–º–µ–Ω–∏—Ç—å –Ω–∞–ø—Ä—è–º—É—é —á–µ—Ä–µ–∑ Railway CLI

–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω Railway CLI:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∫–∞ Railway CLI (–µ—Å–ª–∏ –µ—â–µ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
npm i -g @railway/cli

# –ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ –ø—Ä–æ–µ–∫—Ç—É
railway link

# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
railway run psql $DATABASE_URL < custom-backend/internal/database/migrations/010_add_notification_preferences.sql
railway run psql $DATABASE_URL < custom-backend/internal/database/migrations/011_add_stripe_webhooks.sql
railway run psql $DATABASE_URL < custom-backend/internal/database/migrations/013_add_referral_system.sql
```

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è

–ü–æ–¥–∫–ª—é—á–∏—Ç–µ—Å—å –∫ Railway –ë–î –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:

```sql
-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞–ª–∏—á–∏–µ —Ç–∞–±–ª–∏—Ü
SELECT table_name FROM information_schema.tables 
WHERE table_schema = 'public' 
AND table_name IN ('user_notification_preferences', 'stripe_webhook_events', 'referral_codes', 'referral_invitations', 'referral_rewards');

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ notification preferences
SELECT COUNT(*) FROM user_notification_preferences;

-- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã—Ö –∫–æ–¥–æ–≤
SELECT COUNT(*) FROM referral_codes;
```

## ‚ùì –ï—Å–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ–º

–£–±–µ–¥–∏—Ç–µ—Å—å —á—Ç–æ:
1. ‚úÖ Railway PostgreSQL —Å–µ—Ä–≤–∏—Å –∑–∞–ø—É—â–µ–Ω
2. ‚úÖ URL —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é (–Ω–∞—á–∏–Ω–∞–µ—Ç—Å—è —Å `postgresql://`)
3. ‚úÖ URL –≤ –∫–∞–≤—ã—á–∫–∞—Ö –ø—Ä–∏ —ç–∫—Å–ø–æ—Ä—Ç–µ: `export RAILWAY_DATABASE_URL='–ø–æ–ª–Ω—ã–π_url_–∑–¥–µ—Å—å'`
4. ‚úÖ psql —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –Ω–∞ –≤–∞—à–µ–π –º–∞—à–∏–Ω–µ: `psql --version`
