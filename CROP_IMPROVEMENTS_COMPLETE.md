# –£–ª—É—á—à–µ–Ω–∏—è —Å–∏—Å—Ç–µ–º—ã –∫—Ä–æ–ø–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π - –ó–∞–≤–µ—Ä—à–µ–Ω–æ

## –î–∞—Ç–∞: 27.10.2025

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–£—Ä–æ–≤–µ–Ω—å 1)

### 1. ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ
**–§–∞–π–ª**: `client/components/CreatePostBox/MediaEditor.tsx`

–¢–µ–ø–µ—Ä—å –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ—Ç—Å—è –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –ø—Ä–µ—Å–µ—Ç:
- **Landscape** (width/height ‚â• 1.5) ‚Üí –ü—Ä–µ—Å–µ—Ç **Wide** (16:9)
- **Portrait** (width/height ‚â§ 0.8) ‚Üí –ü—Ä–µ—Å–µ—Ç **Original**
- **Near Square** (0.8 < ratio < 1.5) ‚Üí –ü—Ä–µ—Å–µ—Ç **Square** (1:1)

```typescript
onLoad={(e) => {
  const img = e.currentTarget;
  const natW = img.naturalWidth;
  const natH = img.naturalHeight;
  setNaturalDimensions({ width: natW, height: natH });

  // Auto-select preset based on image aspect ratio
  const aspectRatio = natW / natH;
  if (aspectRatio >= 1.5) {
    setAspectPreset("wide");
  } else if (aspectRatio <= 0.8) {
    setAspectPreset("original");
  } else {
    setAspectPreset("square");
  }
}}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é –Ω–µ –Ω—É–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –≤—ã–±–∏—Ä–∞—Ç—å –ø—Ä–µ—Å–µ—Ç
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–±–∏—Ä–∞–µ—Ç—Å—è –Ω–∞–∏–±–æ–ª–µ–µ –ø–æ–¥—Ö–æ–¥—è—â–∏–π —Ñ–æ—Ä–º–∞—Ç
- –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –ø—Ä–∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏

---

### 2. ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–∏ –∫—Ä–æ–ø–∞ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–µ—Å–µ—Ç–æ–≤
**–§–∞–π–ª**: `client/components/CreatePostBox/MediaEditor.tsx`

–¢–µ–ø–µ—Ä—å –∫–∞–∂–¥—ã–π –ø—Ä–µ—Å–µ—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤–æ—é –ø–æ–∑–∏—Ü–∏—é –∏ –∑—É–º:

```typescript
// Store transform state for each preset
const presetTransforms = useRef<{
  [key in AspectPreset]: { zoom: number; x: number; y: number };
}>({
  original: { zoom: 1, x: 0, y: 0 },
  wide: { zoom: 1, x: 0, y: 0 },
  square: { zoom: 1, x: 0, y: 0 },
});

const handleAspectChange = (preset: AspectPreset) => {
  // Save current transform state
  presetTransforms.current[aspectPreset] = {
    zoom,
    x: translateX,
    y: translateY,
  };

  // Load saved transform for new preset
  const savedTransform = presetTransforms.current[preset];
  setAspectPreset(preset);
  setZoom(savedTransform.zoom);
  setTranslateX(savedTransform.x);
  setTranslateY(savedTransform.y);
};
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç—å—Å—è –º–µ–∂–¥—É –ø—Ä–µ—Å–µ—Ç–∞–º–∏ –±–µ–∑ –ø–æ—Ç–µ—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–µ–∫
- –ö–∞–∂–¥—ã–π –ø—Ä–µ—Å–µ—Ç "–∑–∞–ø–æ–º–∏–Ω–∞–µ—Ç" —Å–≤–æ—é –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
- –£–¥–æ–±–Ω–æ —Å—Ä–∞–≤–Ω–∏–≤–∞—Ç—å —Ä–∞–∑–Ω—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã –∫—Ä–æ–ø–∞

---

### 3. ‚úÖ –£–ª—É—á—à–µ–Ω–Ω–æ–µ –ø—Ä–µ–≤—å—é –≤ MediaGrid
**–§–∞–π–ª**: `client/components/CreatePostBox/MediaGrid.tsx`

–ü—Ä–µ–≤—å—é —Ç–µ–ø–µ—Ä—å –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –∫–æ–ª–∏—á–µ—Å—Ç–≤—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π:

```typescript
// For single image: use auto aspect ratio to show full image
// For multiple images: use 16:9 for consistency
const getAspectRatio = (index: number) => {
  if (media.length === 1) {
    return "auto"; // Show full image without cropping
  }
  return "16/9"; // Consistent grid for multiple images
};
```

**–ò–∑–º–µ–Ω–µ–Ω–∏—è**:
- **–û–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ**: 
  - `aspectRatio: "auto"` - –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø–æ–ª–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
  - `objectFit: "contain"` - –±–µ–∑ –æ–±—Ä–µ–∑–∫–∏
  - `max-h-[500px]` - —É–≤–µ–ª–∏—á–µ–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞
  
- **–ù–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π**:
  - `aspectRatio: "16/9"` - –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è —Å–µ—Ç–∫–∞
  - `objectFit: "cover"` - –∑–∞–ø–æ–ª–Ω–µ–Ω–∏–µ —Å –æ–±—Ä–µ–∑–∫–æ–π
  - `max-h-[280px]` - —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –≤—ã—Å–æ—Ç–∞

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞**:
- –û–¥–∏–Ω–æ—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é, –∫–∞–∫ –≤ Twitter
- –°–µ—Ç–∫–∞ –∏–∑ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤—ã–≥–ª—è–¥–∏—Ç –∞–∫–∫—É—Ä–∞—Ç–Ω–æ –∏ –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–æ
- –£–ª—É—á—à–µ–Ω–Ω–∞—è —á–∏—Ç–∞–µ–º–æ—Å—Ç—å –ø—Ä–µ–≤—å—é

---

## –°—Ä–∞–≤–Ω–µ–Ω–∏–µ: –î–æ –∏ –ü–æ—Å–ª–µ

### –î–æ —É–ª—É—á—à–µ–Ω–∏–π:
‚ùå –ü—Ä–µ—Å–µ—Ç –≤—Å–µ–≥–¥–∞ —Å–±—Ä–∞—Å—ã–≤–∞–ª—Å—è –Ω–∞ "original"  
‚ùå –ü—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –ø—Ä–µ—Å–µ—Ç–æ–≤ —Ç–µ—Ä—è–ª–∏—Å—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∫—Ä–æ–ø–∞  
‚ùå –û–¥–∏–Ω–æ—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ–±—Ä–µ–∑–∞–ª–∏—Å—å –≤ –ø—Ä–µ–≤—å—é  
‚ùå –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –¥–æ–ª–∂–µ–Ω –±—ã–ª –≤—Ä—É—á–Ω—É—é –≤—ã–±–∏—Ä–∞—Ç—å –ø—Ä–µ—Å–µ—Ç

### –ü–æ—Å–ª–µ —É–ª—É—á—à–µ–Ω–∏–π:
‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä –æ–ø—Ç–∏–º–∞–ª—å–Ω–æ–≥–æ –ø—Ä–µ—Å–µ—Ç–∞  
‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –Ω–∞—Å—Ç—Ä–æ–µ–∫ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø—Ä–µ—Å–µ—Ç–∞  
‚úÖ –û–¥–∏–Ω–æ—á–Ω—ã–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é  
‚úÖ –£–º–Ω—ã–π UX, —ç–∫–æ–Ω–æ–º—è—â–∏–π –≤—Ä–µ–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

---

## –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º

### Twitter / X
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –≤—ã–±–æ—Ä —Ñ–æ—Ä–º–∞—Ç–∞ (–ø–æ—Ö–æ–∂–µ –Ω–∞ –∞–ª–≥–æ—Ä–∏—Ç–º Twitter)
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π –º–µ–∂–¥—É –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è–º–∏
- ‚úÖ –ü–æ–ª–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### Instagram
- ‚úÖ –ö–≤–∞–¥—Ä–∞—Ç–Ω—ã–π –ø—Ä–µ—Å–µ—Ç –¥–ª—è near-square –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
- ‚úÖ –ï–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è —Å–µ—Ç–∫–∞ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### Cloudflare Images
- ‚úÖ –£–º–Ω—ã–π –∞–≤—Ç–æ–≤—ã–±–æ—Ä (–ø–æ–¥–æ–±–Ω–æ `gravity=auto`)
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö aspect ratios

---

## –§–∞–π–ª—ã, –∏–∑–º–µ–Ω–µ–Ω–Ω—ã–µ –≤ —ç—Ç–æ–º –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏

1. **client/components/CreatePostBox/MediaEditor.tsx**
   - –î–æ–±–∞–≤–ª–µ–Ω `presetTransforms` useRef –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏–π
   - –û–±–Ω–æ–≤–ª—ë–Ω `handleAspectChange` –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è/–∑–∞–≥—Ä—É–∑–∫–∏ —Ç—Ä–∞–Ω—Å—Ñ–æ—Ä–º–∞—Ü–∏–π
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –∞–≤—Ç–æ–≤—ã–±–æ—Ä–∞ –ø—Ä–µ—Å–µ—Ç–∞ –≤ `onLoad`

2. **client/components/CreatePostBox/MediaGrid.tsx**
   - –î–æ–±–∞–≤–ª–µ–Ω–∞ —Ñ—É–Ω–∫—Ü–∏—è `getAspectRatio()` –¥–ª—è –∞–¥–∞–ø—Ç–∏–≤–Ω–æ–≥–æ aspect ratio
   - –ò–∑–º–µ–Ω—ë–Ω `objectFit` –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
   - –£–≤–µ–ª–∏—á–µ–Ω–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã—Å–æ—Ç–∞ –¥–ª—è –æ–¥–∏–Ω–æ—á–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π (500px)

---

## –î–∞–ª—å–Ω–µ–π—à–∏–µ –≤–æ–∑–º–æ–∂–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (–£—Ä–æ–≤–µ–Ω—å 2-3)

### –£—Ä–æ–≤–µ–Ω—å 2 - Smart Features (2-4 —á–∞—Å–∞)
- üîÑ –ê–≤—Ç–æ—Ü–µ–Ω—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ –∫–æ–Ω—Ç—Ä–∞—Å—Ç—É/—è—Ä–∫–æ—Å—Ç–∏
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è face-api.js –¥–ª—è –¥–µ—Ç–µ–∫—Ü–∏–∏ –ª–∏—Ü
- üîÑ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –ø—Ä–µ—Å–µ—Ç—ã (4:5, 3:4, 2:3)

### –£—Ä–æ–≤–µ–Ω—å 3 - Advanced (4-8 —á–∞—Å–æ–≤)
- üîÑ –†–µ–∂–∏–º —Å–≤–æ–±–æ–¥–Ω–æ–≥–æ –∫—Ä–æ–ø–∞ (Freeform)
- üîÑ Saliency detection —Å ML
- üîÑ Cloudflare-–ø–æ–¥–æ–±–Ω—ã–π `gravity=auto`

---

## –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–ê–≤—Ç–æ–≤—ã–±–æ—Ä –ø—Ä–µ—Å–µ—Ç–∞**:
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å —à–∏—Ä–æ–∫–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ (landscape) ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å—Å—è Wide
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Ä—Ç–∏–∫–∞–ª—å–Ω–æ–µ (portrait) ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å—Å—è Original
   - –ó–∞–≥—Ä—É–∑–∏—Ç—å –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ ‚Üí –¥–æ–ª–∂–µ–Ω –≤—ã–±—Ä–∞—Ç—å—Å—è Square

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ–∑–∏—Ü–∏–π**:
   - –û—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å –∫—Ä–æ–ø –≤ –ø—Ä–µ—Å–µ—Ç–µ Wide (zoom, position)
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å—Å—è –Ω–∞ Square, –æ—Ç—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å
   - –í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ Wide ‚Üí –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –¥–æ–ª–∂–Ω—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å—Å—è

3. **–ü—Ä–µ–≤—å—é**:
   - –î–æ–±–∞–≤–∏—Ç—å –æ–¥–Ω–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ ‚Üí –¥–æ–ª–∂–Ω–æ –ø–æ–∫–∞–∑—ã–≤–∞—Ç—å—Å—è –ø–æ–ª–Ω–æ—Å—Ç—å—é
   - –î–æ–±–∞–≤–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π ‚Üí –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–Ω–∞—è —Å–µ—Ç–∫–∞ 16:9

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –≤—Å–µ —É–ª—É—á—à–µ–Ω–∏—è **–£—Ä–æ–≤–Ω—è 1**, –∫–æ—Ç–æ—Ä—ã–µ –∑–Ω–∞—á–∏—Ç–µ–ª—å–Ω–æ —É–ª—É—á—à–∞—é—Ç UX:
- –ú–µ–Ω—å—à–µ —Ä—É—á–Ω—ã—Ö –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ò–Ω—Ç—É–∏—Ç–∏–≤–Ω–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–µ–µ –æ–∂–∏–¥–∞–Ω–∏—è–º
- –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ –ª—É—á—à–∏–º –ø—Ä–∞–∫—Ç–∏–∫–∞–º –∏–Ω–¥—É—Å—Ç—Ä–∏–∏ (Twitter, Instagram)

–°–∏—Å—Ç–µ–º–∞ –∫—Ä–æ–ø–∞ —Ç–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç **—É–º–Ω–µ–µ** –∏ **—É–¥–æ–±–Ω–µ–µ**, —ç–∫–æ–Ω–æ–º—è –≤—Ä–µ–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã.
