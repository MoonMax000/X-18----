# üìã –ö–æ–Ω—Ç–µ–∫—Å—Ç —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ —Ä–∞–±–æ—Ç—ã

## üéØ –ò—Å—Ö–æ–¥–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ó–∞–ø—Ä–æ—Å 1
> "–ø–µ—Ä–µ—Å–æ–±–µ—Ä–∏ –∞–¥–º–∏–Ω–∫—É —Å –Ω—É–ª—è –∑–∞–Ω–æ–≥–æ –∏ —Ñ—Ä–æ–Ω—Ç –∏ –±—ç–∫ –∏ —Ä–µ–∞–ª–∏–∑—É–π –µ–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—É—é, –∞ —Ç–æ —Å–µ–π—á–∞—Å—à–Ω—è—è –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤–æ–æ–±—â–µ"

### –ó–∞–ø—Ä–æ—Å 2
> "–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π —á—Ç–æ–±—ã —Ä–∞–±–æ—Ç–∞–ª–∞ OTP –≤ –ø—Ä–æ—Ñ–∏–ª–µ –≤ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏, –∏–ª–∏ –≥–¥–µ —Ç—ã –µ–µ —Å–¥–µ–ª–∞–ª, –ø—Ä–æ–≤–µ—Ä—å —á—Ç–æ–±—ã –≤—Å–µ —Ä–∞–±–æ—Ç–∞–ª–æ —Ç–∞–º"

### –ü–æ–¥—Ö–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**–í–∞—Ä–∏–∞–Ω—Ç –ë - –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ**: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∑–Ω–∞—á–∏—Ç admin —Ä–æ–ª—å, —è –ø—Ä–∏–º–µ–Ω—é TOTP –º–∏–≥—Ä–∞—Ü–∏—é –∫ Railway, —Ç–µ—Å—Ç–∏—Ä—É–µ–º –≤–º–µ—Å—Ç–µ.

---

## ‚úÖ –ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏

### 1. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ Admin Panel
**–§–∞–π–ª**: `ADMIN_AND_TOTP_DIAGNOSTIC_COMPLETE.md`

**–í—ã–≤–æ–¥**: Admin Panel **–ù–ï —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏** - –æ–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤!
- ‚úÖ Backend handlers: `custom-backend/internal/api/admin.go`
- ‚úÖ Middleware: `custom-backend/pkg/middleware/admin.go`
- ‚úÖ Frontend –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
  - `client/components/admin/AdminLayout.tsx`
  - `client/pages/admin/AdminDashboard.tsx`
  - `client/pages/admin/AdminNews.tsx`
  - `client/pages/admin/AdminUsers.tsx`
  - `client/pages/admin/AdminReports.tsx`
- ‚úÖ –†–æ—É—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã –≤ `client/App.tsx`
- ‚úÖ –•—É–∫–∏: `client/hooks/useAdmin.ts`

**–ü—Ä–æ–±–ª–µ–º–∞**: –£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–æ—Å—Ç–æ –Ω–µ—Ç —Ä–æ–ª–∏ `admin` –≤ –ë–î.

### 2. –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ TOTP (2FA)
**–§–∞–π–ª**: `ADMIN_AND_TOTP_DIAGNOSTIC_COMPLETE.md`

**–í—ã–≤–æ–¥**: TOTP —Å–∏—Å—Ç–µ–º–∞ **–ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞** - 100% –≥–æ—Ç–æ–≤–∞!

**Backend (–≤—Å–µ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç)**:
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è: `custom-backend/internal/database/migrations/009_add_totp_and_deactivation_fields.sql`
- ‚úÖ Utils: `custom-backend/pkg/utils/totp.go`, `custom-backend/pkg/utils/encryption.go`
- ‚úÖ API handlers: `custom-backend/internal/api/totp_handlers.go`
- ‚úÖ Protected operations: `custom-backend/internal/api/protected_operations.go`
- ‚úÖ Middleware: `custom-backend/pkg/middleware/totp_required.go`
- ‚úÖ Services: `custom-backend/internal/services/account.go`

**Frontend (–≤—Å–µ —Ñ–∞–π–ª—ã —Å—É—â–µ—Å—Ç–≤—É—é—Ç)**:
- ‚úÖ Hooks: `client/hooks/useTOTP.ts`, `client/hooks/useProtectedOperations.ts`
- ‚úÖ Components: `client/components/auth/TOTPVerificationModal.tsx`
- ‚úÖ Integration: `client/components/socialProfile/ProfileSecuritySettings.tsx`

**–ü—Ä–æ–±–ª–µ–º–∞**: –ù—É–∂–Ω–æ –ø—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é 009 –∫ Railway –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å `ENCRYPTION_KEY`.

### 3. –°–æ–∑–¥–∞–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤ –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–π

#### –°–∫—Ä–∏–ø—Ç TOTP –¥–µ–ø–ª–æ—è
**–§–∞–π–ª**: `apply-totp-to-railway.sh`

**–ß—Ç–æ –¥–µ–ª–∞–µ—Ç**:
1. –ü—Ä–∏–º–µ–Ω—è–µ—Ç –º–∏–≥—Ä–∞—Ü–∏—é 009 –∫ Railway DB
2. –ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç ENCRYPTION_KEY (32 –±–∞–π—Ç–∞ base64)
3. –ü—ã—Ç–∞–µ—Ç—Å—è —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é –≤ Railway

**–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
- ‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è 009 **–£–ñ–ï –ë–´–õ–ê** –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ –∫ Railway (–∫–æ–ª–æ–Ω–∫–∏ —Å—É—â–µ—Å—Ç–≤—É—é—Ç)
- ‚úÖ ENCRYPTION_KEY —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: `MMaiIy3dKPYpFZ9eSKVOD03AEsffPn80E/ik2sIRSO0=`
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω –≤ —Ñ–∞–π–ª: `.railway-encryption-key.txt`
- ‚ùå Railway CLI –∫–æ–º–∞–Ω–¥–∞ `railway variables set` –Ω–µ —Å—Ä–∞–±–æ—Ç–∞–ª–∞ (–Ω–µ–≤–µ—Ä–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å)
- ‚úÖ –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏–ª —á–µ—Ä–µ–∑: `railway variables --set ENCRYPTION_KEY="..."`

#### –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
**–°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã**:
1. `QUICK_ADMIN_SETUP.md` - –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –Ω–∞–∑–Ω–∞—á–µ–Ω–∏—è admin —Ä–æ–ª–∏
2. `–§–ò–ù–ê–õ–¨–ù–ê–Ø_–ù–ê–°–¢–†–û–ô–ö–ê_ADMIN_–ò_TOTP.md` - –ø–æ–ª–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ
3. `–ë–´–°–¢–†–´–ï_–ö–û–ú–ê–ù–î–´_–§–ò–ù–ê–õ–¨–ù–û–ô_–ù–ê–°–¢–†–û–ô–ö–ò.md` - –∫—Ä–∞—Ç–∫–∞—è –≤–µ—Ä—Å–∏—è
4. `–ü–û–°–õ–ï–î–ù–ò–ô_–®–ê–ì_ADMIN_–†–û–õ–¨.md` - —Ñ–∏–Ω–∞–ª—å–Ω—ã–π —à–∞–≥
5. `–ü–†–ê–í–ò–õ–¨–ù–´–ï_PRODUCTION_URL.md` - —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫ –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö URL

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ Production URL

**–ü—Ä–æ–±–ª–µ–º–∞**: –í–æ –≤—Å–µ—Ö –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è—Ö –±—ã–ª–∏ —Å—Ç–∞—Ä—ã–µ netlify URL (`x-18.netlify.app`, `sunny-froyo-f47377.netlify.app` –∏ —Ç.–¥.)

**–ü—Ä–∞–≤–∏–ª—å–Ω—ã–π –¥–æ–º–µ–Ω**: `social.tyriantrade.com`

**–û–±–Ω–æ–≤–ª–µ–Ω—ã —Ñ–∞–π–ª—ã**:
- `–ü–û–°–õ–ï–î–ù–ò–ô_–®–ê–ì_ADMIN_–†–û–õ–¨.md`
- `–ë–´–°–¢–†–´–ï_–ö–û–ú–ê–ù–î–´_–§–ò–ù–ê–õ–¨–ù–û–ô_–ù–ê–°–¢–†–û–ô–ö–ò.md`
- `–§–ò–ù–ê–õ–¨–ù–ê–Ø_–ù–ê–°–¢–†–û–ô–ö–ê_ADMIN_–ò_TOTP.md`

**–°–æ–∑–¥–∞–Ω —Å–ø—Ä–∞–≤–æ—á–Ω–∏–∫**: `–ü–†–ê–í–ò–õ–¨–ù–´–ï_PRODUCTION_URL.md` —Å–æ –≤—Å–µ–º–∏ –∞–∫—Ç—É–∞–ª—å–Ω—ã–º–∏ –∞–¥—Ä–µ—Å–∞–º–∏.

---

## ‚ùå –ß—Ç–æ –ù–ï —Å–¥–µ–ª–∞–Ω–æ (—Ç—Ä–µ–±—É–µ—Ç –¥–µ–π—Å—Ç–≤–∏–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)

### 1. –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ Admin —Ä–æ–ª–∏
**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è**:
```bash
railway connect postgres
UPDATE users SET role = 'admin' WHERE username = 'admin2';
SELECT id, username, email, role FROM users WHERE username = 'admin2';
\q
```

**Username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è**: `admin2`

### 2. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ Admin Panel
**URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**:
- Production: `https://social.tyriantrade.com/admin`
- –õ–æ–∫–∞–ª—å–Ω–æ: `http://localhost:5173/admin`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- Dashboard –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è
- –ú–æ–∂–Ω–æ –ø—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ú–æ–∂–Ω–æ –º–µ–Ω—è—Ç—å —Ä–æ–ª–∏
- –ú–æ–∂–Ω–æ —É–ø—Ä–∞–≤–ª—è—Ç—å –Ω–æ–≤–æ—Å—Ç—è–º–∏

### 3. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ TOTP (2FA)
**URL –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏**:
- Production: `https://social.tyriantrade.com/profile?tab=profile&profileTab=security`
- –õ–æ–∫–∞–ª—å–Ω–æ: `http://localhost:5173/profile/security`

**–ß—Ç–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å**:
- –ö–Ω–æ–ø–∫–∞ "Enable 2FA" —Ä–∞–±–æ—Ç–∞–µ—Ç
- –ü–æ—è–≤–ª—è–µ—Ç—Å—è QR –∫–æ–¥
- –ö–æ–¥ –∏–∑ Google Authenticator –ø—Ä–∏–Ω–∏–º–∞–µ—Ç—Å—è
- –í—ã–¥–∞—é—Ç—Å—è backup –∫–æ–¥—ã
- TOTP –∑–∞–ø—Ä–∞—à–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª—è/email/—Ç–µ–ª–µ—Ñ–æ–Ω–∞

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –í–∞–∂–Ω—ã–µ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏

```
/Users/devidanderson/Projects/X-18----/
‚îú‚îÄ‚îÄ client/                          # Frontend React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ components/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin/                   # Admin Panel –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ AdminLayout.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ auth/                    # –ú–æ–¥–∞–ª–∫–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ TOTPVerificationModal.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ socialProfile/           # –ü—Ä–æ—Ñ–∏–ª—å –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ ProfileSecuritySettings.tsx
‚îÇ   ‚îú‚îÄ‚îÄ pages/
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ admin/                   # –°—Ç—Ä–∞–Ω–∏—Ü—ã –∞–¥–º–∏–Ω–∫–∏
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AdminDashboard.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AdminNews.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ AdminUsers.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ AdminReports.tsx
‚îÇ   ‚îú‚îÄ‚îÄ hooks/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAdmin.ts              # –•—É–∫–∏ –∞–¥–º–∏–Ω–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useTOTP.ts               # –•—É–∫–∏ TOTP
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useProtectedOperations.ts
‚îÇ   ‚îî‚îÄ‚îÄ App.tsx                      # –†–æ—É—Ç—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ
‚îú‚îÄ‚îÄ custom-backend/                  # Backend Go –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
‚îÇ   ‚îú‚îÄ‚îÄ cmd/server/main.go          # Entry point
‚îÇ   ‚îú‚îÄ‚îÄ internal/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ api/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ admin.go            # Admin API endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ totp_handlers.go    # TOTP API endpoints
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ protected_operations.go
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ auth.go
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ models/
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ user.go             # User model —Å TOTP –ø–æ–ª—è–º–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ account.go          # Account management
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ security.go
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ database/
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ migrations/
‚îÇ   ‚îÇ           ‚îî‚îÄ‚îÄ 009_add_totp_and_deactivation_fields.sql
‚îÇ   ‚îî‚îÄ‚îÄ pkg/
‚îÇ       ‚îú‚îÄ‚îÄ middleware/
‚îÇ       ‚îÇ   ‚îú‚îÄ‚îÄ admin.go            # Admin access middleware
‚îÇ       ‚îÇ   ‚îî‚îÄ‚îÄ totp_required.go    # TOTP verification middleware
‚îÇ       ‚îî‚îÄ‚îÄ utils/
‚îÇ           ‚îú‚îÄ‚îÄ totp.go             # TOTP logic
‚îÇ           ‚îî‚îÄ‚îÄ encryption.go       # AES-256-GCM encryption
‚îÇ
‚îî‚îÄ‚îÄ [–ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –∏ —Å–∫—Ä–∏–ø—Ç—ã]
    ‚îú‚îÄ‚îÄ ADMIN_AND_TOTP_DIAGNOSTIC_COMPLETE.md
    ‚îú‚îÄ‚îÄ QUICK_ADMIN_SETUP.md
    ‚îú‚îÄ‚îÄ –§–ò–ù–ê–õ–¨–ù–ê–Ø_–ù–ê–°–¢–†–û–ô–ö–ê_ADMIN_–ò_TOTP.md
    ‚îú‚îÄ‚îÄ –ë–´–°–¢–†–´–ï_–ö–û–ú–ê–ù–î–´_–§–ò–ù–ê–õ–¨–ù–û–ô_–ù–ê–°–¢–†–û–ô–ö–ò.md
    ‚îú‚îÄ‚îÄ –ü–û–°–õ–ï–î–ù–ò–ô_–®–ê–ì_ADMIN_–†–û–õ–¨.md
    ‚îú‚îÄ‚îÄ –ü–†–ê–í–ò–õ–¨–ù–´–ï_PRODUCTION_URL.md
    ‚îú‚îÄ‚îÄ apply-totp-to-railway.sh
    ‚îî‚îÄ‚îÄ .railway-encryption-key.txt
```

---

## üîê –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

### ENCRYPTION_KEY (–¥–ª—è TOTP)
```
MMaiIy3dKPYpFZ9eSKVOD03AEsffPn80E/ik2sIRSO0=
```
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Railway —á–µ—Ä–µ–∑ `railway variables --set`

**–ì–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è**:
- Railway: Environment Variables
- –õ–æ–∫–∞–ª—å–Ω–æ: –§–∞–π–ª `.railway-encryption-key.txt`

### Database Connection
**Railway PostgreSQL**: –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `railway connect postgres`

**–õ–æ–∫–∞–ª—å–Ω–∞—è –ë–î**:
```
postgresql://postgres:postgres@localhost:5432/social_network
```

### Production URLs
**Frontend**: `https://social.tyriantrade.com`
**Backend**: `https://x-18-production-38ec.up.railway.app`

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –¢–∞–±–ª–∏—Ü–∞ `users`

**TOTP –∫–æ–ª–æ–Ω–∫–∏** (–∏–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ 009):
```sql
totp_secret TEXT                    -- –ó–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–Ω—ã–π TOTP —Å–µ–∫—Ä–µ—Ç
totp_enabled BOOLEAN DEFAULT FALSE  -- TOTP –≤–∫–ª—é—á–µ–Ω?
totp_backup_codes TEXT[]            -- Backup –∫–æ–¥—ã
backup_email VARCHAR(255)           -- Email –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
backup_phone VARCHAR(20)            -- –¢–µ–ª–µ—Ñ–æ–Ω –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è
account_status VARCHAR(20)          -- active/suspended/deactivated
deactivation_reason TEXT            -- –ü—Ä–∏—á–∏–Ω–∞ –¥–µ–∞–∫—Ç–∏–≤–∞—Ü–∏–∏
last_security_check TIMESTAMP       -- –ü–æ—Å–ª–µ–¥–Ω—è—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
```

**Admin –∫–æ–ª–æ–Ω–∫–∞** (–∏–∑ –º–∏–≥—Ä–∞—Ü–∏–∏ 007):
```sql
role VARCHAR(20) DEFAULT 'user'     -- user/moderator/admin
```

### –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏ –∫ Railway
- ‚úÖ 001-008: –ë–∞–∑–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞
- ‚úÖ 009: TOTP –∏ deactivation –ø–æ–ª—è
- ‚úÖ 010: Notification preferences
- ‚úÖ 011: Stripe webhooks
- ‚úÖ 013: Referral system

---

## üîß Railway Environment Variables

### –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
```env
ENCRYPTION_KEY=MMaiIy3dKPYpFZ9eSKVOD03AEsffPn80E/ik2sIRSO0=
CORS_ORIGIN=https://social.tyriantrade.com
FRONTEND_URL=https://social.tyriantrade.com
DATABASE_URL=[–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏]
REDIS_URL=[–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏]
JWT_SECRET=[—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω]
```

---

## üìù –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω–æ:
1. ‚úÖ –ù–∞–∑–Ω–∞—á–∏—Ç—å —Ä–æ–ª—å admin:
   ```bash
   railway connect postgres
   UPDATE users SET role = 'admin' WHERE username = 'admin2';
   \q
   ```

### –ó–∞—Ç–µ–º –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:
2. Admin Panel: https://social.tyriantrade.com/admin
3. TOTP: https://social.tyriantrade.com/profile?tab=profile&profileTab=security

### –ü–æ—Å–ª–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:
4. –°–æ–æ–±—â–∏—Ç—å —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã:
   - Admin Panel —Ä–∞–±–æ—Ç–∞–µ—Ç? (–¥–∞/–Ω–µ—Ç/–æ—à–∏–±–∫–∞)
   - TOTP —Ä–∞–±–æ—Ç–∞–µ—Ç? (–¥–∞/–Ω–µ—Ç/–æ—à–∏–±–∫–∞)

---

## üéØ –í–∞–∂–Ω—ã–µ –≤—ã–≤–æ–¥—ã

### Admin Panel
- **–ù–ï —Ç—Ä–µ–±—É–µ—Ç –ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏** - –∫–æ–¥ –≥–æ—Ç–æ–≤ –Ω–∞ 100%
- **–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞**: –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ä–æ–ª–∏ `admin` —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- **–†–µ—à–µ–Ω–∏–µ**: –ü—Ä–æ—Å—Ç–æ–π SQL –∑–∞–ø—Ä–æ—Å `UPDATE users SET role = 'admin'`

### TOTP (2FA)
- **–ù–ï —Ç—Ä–µ–±—É–µ—Ç –Ω–æ–≤–æ–π —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏** - —Å–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –Ω–∞ 100%
- **–ü—Ä–æ–±–ª–µ–º–∞ –±—ã–ª–∞**: 
  1. –ú–∏–≥—Ä–∞—Ü–∏—è 009 –Ω–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∞ (–æ–∫–∞–∑–∞–ª–æ—Å—å - —É–∂–µ –±—ã–ª–∞)
  2. ENCRYPTION_KEY –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω (—Ç–µ–ø–µ—Ä—å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
- **–†–µ—à–µ–Ω–∏–µ**: –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ Railway

### –ì–ª–∞–≤–Ω—ã–π —É—Ä–æ–∫
–û–±–µ —Å–∏—Å—Ç–µ–º—ã –±—ã–ª–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã —Ä–∞–Ω–µ–µ, –ø—Ä–æ—Å—Ç–æ —Ç—Ä–µ–±–æ–≤–∞–ª–∏ **–∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏**, –∞ –Ω–µ **–ø–µ—Ä–µ—Å–±–æ—Ä–∫–∏**.

---

## üìû –î–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —á–∞—Ç–∞

**–°–∫–∞–∂–∏ –Ω–æ–≤–æ–º—É Cline**:
1. –ü—Ä–æ—á–∏—Ç–∞–π —ç—Ç–æ—Ç —Ñ–∞–π–ª: `–ö–û–ù–¢–ï–ö–°–¢_–¢–ï–ö–£–©–ï–ô_–°–ï–°–°–ò–ò.md`
2. Username –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: `admin2`
3. Production domain: `social.tyriantrade.com`
4. ENCRYPTION_KEY —É–∂–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –≤ Railway
5. –û—Å—Ç–∞–ª–æ—Å—å —Ç–æ–ª—å–∫–æ –Ω–∞–∑–Ω–∞—á–∏—Ç—å admin —Ä–æ–ª—å –∏ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å

**–ö–ª—é—á–µ–≤—ã–µ —Ñ–∞–π–ª—ã –¥–ª—è —Å–ø—Ä–∞–≤–∫–∏**:
- `–ü–†–ê–í–ò–õ–¨–ù–´–ï_PRODUCTION_URL.md` - –≤—Å–µ –∞–∫—Ç—É–∞–ª—å–Ω—ã–µ URL
- `–ü–û–°–õ–ï–î–ù–ò–ô_–®–ê–ì_ADMIN_–†–û–õ–¨.md` - —á—Ç–æ –¥–µ–ª–∞—Ç—å –¥–∞–ª—å—à–µ
- `ADMIN_AND_TOTP_DIAGNOSTIC_COMPLETE.md` - –ø–æ–ª–Ω–∞—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞

---

## üïê –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
**–°–µ—Å—Å–∏—è**: 31 –æ–∫—Ç—è–±—Ä—è 2025, ~08:00-09:06 (Asia/Saigon, UTC+7)

**Git commit**: `30df6f68137070bfc2180999b33c664f53b66e1a`

---

**–ö–æ–Ω–µ—Ü –æ—Ç—á–µ—Ç–∞ –æ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏**
